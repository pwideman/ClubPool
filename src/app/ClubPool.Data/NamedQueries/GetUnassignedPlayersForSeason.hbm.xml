<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2">
  <sql-query name="GetUnassignedPlayersForSeason">
    <return alias="User" class="ClubPool.Core.User, ClubPool.Core" />
    select * from Users where IsApproved = 1 and id not in (select distinct u.id from Users u, TeamsPlayers tp, Teams t, Divisions d, Seasons s where u.Id = tp.UserId and s.id in (select SeasonId from Divisions where Id in (select divisionid from Teams where id = tp.teamid)) and s.id = :SeasonId);
  </sql-query>
</hibernate-mapping>